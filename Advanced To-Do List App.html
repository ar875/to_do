<!DOCTYPE html>
<!-- saved from url=(0053)file:///Users/arpitkumar/Downloads/todo_html_app.html -->
<html lang="en" data-theme="light"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced To-Do List App</title>
    <style>
        :root {
            --primary-color: #3b82f6;
            --secondary-color: #8b5cf6;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --bg-color: #f9fafb;
            --card-bg: #ffffff;
            --text-color: #111827;
            --text-muted: #6b7280;
            --border-color: #e5e7eb;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
        }

        [data-theme="dark"] {
            --bg-color: #111827;
            --card-bg: #1f2937;
            --text-color: #f9fafb;
            --text-muted: #9ca3af;
            --border-color: #374151;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            min-height: 100vh;
            padding: 20px;
            transition: background-color 0.3s ease, color 0.3s ease;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: var(--card-bg);
            min-height: calc(100vh - 40px);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: var(--shadow);
            transition: background-color 0.3s ease;
        }

        .header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 30px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 100px;
            height: 100px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            animation: float 6s ease-in-out infinite;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: bold;
            animation: slideInDown 0.8s ease;
        }

        @keyframes slideInDown {
            from { opacity: 0; transform: translateY(-30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .header-stats {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            gap: 20px;
            flex-wrap: wrap;
        }

        .stat-item {
            background: rgba(255, 255, 255, 0.2);
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            backdrop-filter: blur(10px);
        }

        .controls-bar {
            padding: 20px 30px;
            background: var(--card-bg);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .search-box {
            display: flex;
            align-items: center;
            background: var(--bg-color);
            border: 2px solid var(--border-color);
            border-radius: 25px;
            padding: 8px 16px;
            flex: 1;
            max-width: 300px;
            transition: border-color 0.3s ease;
        }

        .search-box:focus-within {
            border-color: var(--primary-color);
        }

        .search-box input {
            background: none;
            border: none;
            outline: none;
            flex: 1;
            color: var(--text-color);
            font-size: 14px;
            margin-left: 8px;
        }

        .search-box input::placeholder {
            color: var(--text-muted);
        }

        .control-buttons {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .theme-toggle {
            background: var(--bg-color);
            border: 2px solid var(--border-color);
            color: var(--text-color);
            padding: 8px 12px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .theme-toggle:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .bulk-actions {
            display: flex;
            gap: 8px;
        }

        .bulk-btn {
            padding: 6px 12px;
            background: var(--warning-color);
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .bulk-btn:hover {
            transform: translateY(-1px);
        }

        .content {
            padding: 30px;
        }

        .add-task-section {
            background: var(--bg-color);
            padding: 25px;
            border-radius: 16px;
            margin-bottom: 30px;
            border: 2px solid var(--border-color);
            transition: all 0.3s ease;
        }

        .add-task-form {
            display: grid;
            grid-template-columns: 1fr auto auto auto;
            gap: 12px;
            margin-bottom: 15px;
        }

        .task-input {
            padding: 14px 18px;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            font-size: 16px;
            background: var(--card-bg);
            color: var(--text-color);
            transition: all 0.3s ease;
        }

        .task-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .form-select {
            padding: 14px 18px;
            border: 2px solid var(--border-color);
            border-radius: 12px;
            font-size: 14px;
            background: var(--card-bg);
            color: var(--text-color);
            cursor: pointer;
            min-width: 120px;
        }

        .priority-select {
            min-width: 100px;
        }

        .date-input {
            min-width: 140px;
        }

        .add-btn {
            padding: 14px 20px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 120px;
            justify-content: center;
        }

        .add-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(59, 130, 246, 0.3);
        }

        .quick-add-templates {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .template-btn {
            padding: 6px 12px;
            background: var(--card-bg);
            border: 1px solid var(--border-color);
            color: var(--text-muted);
            border-radius: 15px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .template-btn:hover {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        .filters {
            display: flex;
            gap: 12px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 10px 18px;
            border: 2px solid var(--border-color);
            border-radius: 20px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--card-bg);
            color: var(--text-color);
            position: relative;
        }

        .filter-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
            transform: scale(1.05);
        }

        .filter-btn:not(.active):hover {
            background: var(--bg-color);
            transform: translateY(-1px);
        }

        .tasks-container {
            min-height: 200px;
            position: relative;
        }

        .task-item {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 20px;
            margin-bottom: 16px;
            border: 2px solid var(--border-color);
            border-radius: 16px;
            background: var(--card-bg);
            transition: all 0.3s ease;
            cursor: move;
            position: relative;
            overflow: hidden;
            animation: slideInUp 0.5s ease;
        }

        @keyframes slideInUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .task-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border-color: var(--primary-color);
        }

        .task-item.completed {
            background: linear-gradient(135deg, #f0fdf4, #dcfce7);
            border-color: var(--success-color);
            opacity: 0.8;
        }

        .task-item.dragging {
            opacity: 0.5;
            transform: rotate(5deg);
        }

        .task-item.high-priority::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: var(--danger-color);
        }

        .task-item.medium-priority::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: var(--warning-color);
        }

        .task-item.overdue {
            border-color: var(--danger-color);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .task-checkbox {
            margin-top: 2px;
        }

        .checkbox {
            width: 24px;
            height: 24px;
            border: 2px solid var(--border-color);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            position: relative;
        }

        .checkbox.checked {
            background: var(--success-color);
            border-color: var(--success-color);
            color: white;
            animation: bounce 0.5s ease;
        }

        @keyframes bounce {
            0%, 20%, 60%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            80% { transform: translateY(-5px); }
        }

        .task-content {
            flex: 1;
        }

        .task-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
            flex-wrap: wrap;
        }

        .task-text {
            font-size: 16px;
            font-weight: 500;
            line-height: 1.4;
        }

        .task-text.completed {
            text-decoration: line-through;
            color: var(--text-muted);
        }

        .task-meta {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-top: 8px;
        }

        .task-category, .task-priority, .task-due {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            font-size: 11px;
            font-weight: 600;
            border-radius: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .category-personal { background: #f3e8ff; color: #7c3aed; }
        .category-work { background: #dbeafe; color: #2563eb; }
        .category-shopping { background: #fef3c7; color: #d97706; }
        .category-health { background: #dcfce7; color: #16a34a; }

        .priority-high { background: #fee2e2; color: #dc2626; }
        .priority-medium { background: #fef3c7; color: #d97706; }
        .priority-low { background: #f0f9ff; color: #0ea5e9; }

        .due-today { background: #fef3c7; color: #d97706; }
        .due-overdue { background: #fee2e2; color: #dc2626; }
        .due-upcoming { background: #f0f9ff; color: #0ea5e9; }

        .task-notes {
            font-size: 14px;
            color: var(--text-muted);
            margin-top: 8px;
            line-height: 1.4;
        }

        .task-actions {
            display: flex;
            gap: 6px;
            align-items: flex-start;
            margin-top: 2px;
        }

        .action-btn {
            padding: 8px;
            border: none;
            background: var(--bg-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .action-btn:hover {
            transform: scale(1.1);
        }

        .edit-btn:hover { background: #f3f4f6; color: #374151; }
        .delete-btn:hover { background: #fee2e2; color: #dc2626; }
        .save-btn:hover { background: #dcfce7; color: #16a34a; }
        .cancel-btn:hover { background: #f3f4f6; color: #374151; }

        .edit-input, .edit-textarea {
            width: 100%;
            padding: 8px 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            background: var(--card-bg);
            color: var(--text-color);
            font-family: inherit;
        }

        .edit-textarea {
            resize: vertical;
            min-height: 60px;
            margin-top: 8px;
        }

        .edit-input:focus, .edit-textarea:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--text-muted);
            font-size: 18px;
        }

        .empty-state-icon {
            font-size: 48px;
            margin-bottom: 16px;
            opacity: 0.5;
        }

        .statistics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .stat-card {
            background: var(--card-bg);
            padding: 20px;
            border-radius: 12px;
            border: 1px solid var(--border-color);
            text-align: center;
            transition: all 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow);
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 8px;
        }

        .stat-label {
            color: var(--text-muted);
            font-size: 14px;
        }

        .icon {
            width: 18px;
            height: 18px;
            fill: currentColor;
        }

        .confetti {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }

        .drag-indicator {
            position: absolute;
            left: 8px;
            top: 50%;
            transform: translateY(-50%);
            width: 4px;
            height: 20px;
            background: var(--text-muted);
            border-radius: 2px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .task-item:hover .drag-indicator {
            opacity: 0.5;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--success-color);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            transform: translateX(100%);
            transition: transform 0.3s ease;
            z-index: 1000;
        }

        .notification.show {
            transform: translateX(0);
        }

        @media (max-width: 768px) {
            .container {
                margin: 0;
                border-radius: 0;
                min-height: 100vh;
            }

            .add-task-form {
                grid-template-columns: 1fr;
            }

            .controls-bar {
                flex-direction: column;
                align-items: stretch;
            }

            .search-box {
                max-width: none;
            }

            .header h1 {
                font-size: 2rem;
            }

            .header-stats {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <h1>üöÄ Advanced To-Do List</h1>
                <div class="header-stats">
                    <div class="stat-item">üìä <span id="headerTotal">2</span> Total</div>
                    <div class="stat-item">‚úÖ <span id="headerCompleted">0</span> Completed</div>
                    <div class="stat-item">‚è∞ <span id="headerPending">2</span> Pending</div>
                    <div class="stat-item">üî• <span id="headerStreak">0</span> Day Streak</div>
                </div>
            </div>
        </div>

        <div class="controls-bar">
            <div class="search-box">
                <svg class="icon" viewBox="0 0 24 24">
                    <circle cx="11" cy="11" r="8"></circle>
                    <path d="m21 21-4.35-4.35"></path>
                </svg>
                <input type="text" id="searchInput" placeholder="Search tasks...">
            </div>
            
            <div class="control-buttons">
                <div class="bulk-actions" style="display: none;">
                    <button class="bulk-btn" onclick="bulkComplete()">‚úì Complete All</button>
                    <button class="bulk-btn" onclick="bulkDelete()">üóë Delete All</button>
                </div>
                
                <button class="theme-toggle" onclick="toggleTheme()">
                    <span id="themeIcon">üåô</span>
                </button>
                
                <button class="theme-toggle" onclick="exportTasks()">üíæ Export</button>
                <button class="theme-toggle" onclick="importTasks()">üì• Import</button>
                <input type="file" id="importFile" accept=".json" style="display: none;">
            </div>
        </div>

        <div class="content">
            <div class="add-task-section">
                <div class="add-task-form">
                    <input type="text" id="taskInput" class="task-input" placeholder="Add a new task... (Try: &#39;Buy groceries due tomorrow high priority&#39;)" maxlength="200">
                    <select id="categorySelect" class="form-select">
                        <option value="personal">üìù Personal</option>
                        <option value="work">üíº Work</option>
                        <option value="shopping">üõí Shopping</option>
                        <option value="health">üèÉ Health</option>
                    </select>
                    <select id="prioritySelect" class="form-select priority-select">
                        <option value="low">üîµ Low</option>
                        <option value="medium">üü° Medium</option>
                        <option value="high">üî¥ High</option>
                    </select>
                    <input type="date" id="dueDateInput" class="form-select date-input">
                    <button id="addBtn" class="add-btn">
                        <svg class="icon" viewBox="0 0 24 24">
                            <path d="M12 5v14m-7-7h14"></path>
                        </svg>
                        Add Task
                    </button>
                </div>
                
                <div class="quick-add-templates">
                    <button class="template-btn" onclick="addTemplate(&#39;Call mom&#39;, &#39;personal&#39;, &#39;medium&#39;)">üìû Call mom</button>
                    <button class="template-btn" onclick="addTemplate(&#39;Team meeting&#39;, &#39;work&#39;, &#39;high&#39;)">üë• Team meeting</button>
                    <button class="template-btn" onclick="addTemplate(&#39;Grocery shopping&#39;, &#39;shopping&#39;, &#39;medium&#39;)">üõí Groceries</button>
                    <button class="template-btn" onclick="addTemplate(&#39;30min workout&#39;, &#39;health&#39;, &#39;high&#39;)">üí™ Workout</button>
                    <button class="template-btn" onclick="addTemplate(&#39;Read for 30 minutes&#39;, &#39;personal&#39;, &#39;low&#39;)">üìö Reading</button>
                </div>
                
                <textarea id="taskNotes" class="edit-textarea" placeholder="Add notes or description (optional)..." style="margin-top: 15px; display: none;"></textarea>
            </div>

            <div class="filters">
                <button class="filter-btn active" data-filter="all">üåü All Tasks</button>
                <button class="filter-btn" data-filter="active">‚ö° Active</button>
                <button class="filter-btn" data-filter="completed">‚úÖ Completed</button>
                <button class="filter-btn" data-filter="high">üî¥ High Priority</button>
                <button class="filter-btn" data-filter="today">üìÖ Due Today</button>
                <button class="filter-btn" data-filter="overdue">‚ö†Ô∏è Overdue</button>
            </div>

            <div class="tasks-container" id="tasksContainer">
                <div class="task-item  medium-priority " draggable="true" ondragstart="handleDragStart(event, 1)" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 1)">
                     
                    <div class="drag-indicator"></div>
                    
                    <div class="task-checkbox">
                        <div class="checkbox " onclick="toggleTask(1)">
                            
                        </div>
                    </div>
                    
                    <div class="task-content">
                        
                            <div class="task-header">
                                <div class="task-text ">üéâ Welcome to your advanced to-do app!</div>
                            </div>
                            <div class="task-meta">
                                <span class="task-category category-personal">üìù personal</span>
                                <span class="task-priority priority-medium">üü° medium</span>
                                
                            </div>
                            <div class="task-notes">üí≠ This app has tons of cool features - try dragging tasks around!</div>
                        
                    </div>
                    
                    <div class="task-actions">
                        
                            <button class="action-btn edit-btn" onclick="startEdit(1, &#39;üéâ Welcome to your advanced to-do app!&#39;, &#39;This app has tons of cool features - try dragging tasks around!&#39;)">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                    <path d="m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                </svg>
                            </button>
                            <button class="action-btn delete-btn" onclick="deleteTask(1)">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <line x1="18" y1="6" x2="6" y2="18"></line>
                                    <line x1="6" y1="6" x2="18" y2="18"></line>
                                </svg>
                            </button>
                        
                    </div>
                </div>
            
                <div class="task-item  high-priority " draggable="true" ondragstart="handleDragStart(event, 2)" ondragover="handleDragOver(event)" ondrop="handleDrop(event, 2)">
                     
                    <div class="drag-indicator"></div>
                    
                    <div class="task-checkbox">
                        <div class="checkbox " onclick="toggleTask(2)">
                            
                        </div>
                    </div>
                    
                    <div class="task-content">
                        
                            <div class="task-header">
                                <div class="task-text ">üéØ Try the search, filters, and drag &amp; drop</div>
                            </div>
                            <div class="task-meta">
                                <span class="task-category category-work">üíº work</span>
                                <span class="task-priority priority-high">üî¥ high</span>
                                <span class="task-due due-today">üìÖ Today</span>
                            </div>
                            <div class="task-notes">üí≠ Don't forget to check out the dark mode toggle!</div>
                        
                    </div>
                    
                    <div class="task-actions">
                        
                            <button class="action-btn edit-btn" onclick="startEdit(2, &#39;üéØ Try the search, filters, and drag &amp; drop&#39;, &#39;Don\&#39;t forget to check out the dark mode toggle!&#39;)">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                    <path d="m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                </svg>
                            </button>
                            <button class="action-btn delete-btn" onclick="deleteTask(2)">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <line x1="18" y1="6" x2="6" y2="18"></line>
                                    <line x1="6" y1="6" x2="18" y2="18"></line>
                                </svg>
                            </button>
                        
                    </div>
                </div>
            </div>

            <div class="statistics" id="statistics">
                <div class="stat-card">
                    <div class="stat-value">2</div>
                    <div class="stat-label">Total Tasks</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">0</div>
                    <div class="stat-label">Completed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">2</div>
                    <div class="stat-label">Pending</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">0%</div>
                    <div class="stat-label">Completion Rate</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">1</div>
                    <div class="stat-label">High Priority</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">1</div>
                    <div class="stat-label">Due Today</div>
                </div>
            </div>
        </div>
    </div>

    <div id="notification" class="notification"></div>
    <canvas id="confetti" class="confetti"></canvas>

    <script>
        let tasks = JSON.parse(localStorage.getItem('advancedTodoTasks')) || [
            { 
                id: 1, 
                text: 'üéâ Welcome to your advanced to-do app!', 
                completed: false, 
                category: 'personal', 
                priority: 'medium',
                dueDate: null,
                notes: 'This app has tons of cool features - try dragging tasks around!',
                createdAt: new Date().toISOString()
            },
            { 
                id: 2, 
                text: 'üéØ Try the search, filters, and drag & drop', 
                completed: false, 
                category: 'work', 
                priority: 'high',
                dueDate: new Date().toISOString().split('T')[0],
                notes: 'Don\'t forget to check out the dark mode toggle!',
                createdAt: new Date().toISOString()
            }
        ];
        
        let currentFilter = 'all';
        let editingId = null;
        let searchTerm = '';
        let draggedElement = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadTheme();
            renderTasks();
            updateStatistics();
            setupEventListeners();
            checkDueDates();
            setInterval(checkDueDates, 60000); // Check every minute
        });

        function setupEventListeners() {
            // Search
            document.getElementById('searchInput').addEventListener('input', function(e) {
                searchTerm = e.target.value.toLowerCase();
                renderTasks();
            });

            // Add task
            document.getElementById('addBtn').addEventListener('click', addTask);
            document.getElementById('taskInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') addTask();
            });

            // Smart input parsing
            document.getElementById('taskInput').addEventListener('input', parseSmartInput);

            // Filters
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    setFilter(this.dataset.filter);
                });
            });

            // Import file
            document.getElementById('importFile').addEventListener('change', handleImport);

            // Show notes toggle
            document.getElementById('taskInput').addEventListener('focus', function() {
                document.getElementById('taskNotes').style.display = 'block';
            });

            // Keyboard shortcuts
            document.addEventListener('keydown', handleKeyboardShortcuts);
        }

        function parseSmartInput() {
            const input = document.getElementById('taskInput').value.toLowerCase();
            
            // Auto-detect due date
            if (input.includes('today') || input.includes('due today')) {
                document.getElementById('dueDateInput').value = new Date().toISOString().split('T')[0];
            } else if (input.includes('tomorrow') || input.includes('due tomorrow')) {
                const tomorrow = new Date();
                tomorrow.setDate(tomorrow.getDate() + 1);
                document.getElementById('dueDateInput').value = tomorrow.toISOString().split('T')[0];
            }

            // Auto-detect priority
            if (input.includes('high priority') || input.includes('urgent') || input.includes('important')) {
                document.getElementById('prioritySelect').value = 'high';
            } else if (input.includes('medium priority')) {
                document.getElementById('prioritySelect').value = 'medium';
            } else if (input.includes('low priority')) {
                document.getElementById('prioritySelect').value = 'low';
            }

            // Auto-detect category
            if (input.includes('work') || input.includes('meeting') || input.includes('call') || input.includes('email')) {
                document.getElementById('categorySelect').value = 'work';
            } else if (input.includes('buy') || input.includes('shop') || input.includes('groceries') || input.includes('store')) {
                document.getElementById('categorySelect').value = 'shopping';
            } else if (input.includes('workout') || input.includes('exercise') || input.includes('gym') || input.includes('health')) {
                document.getElementById('categorySelect').value = 'health';
            }
        }

        function handleKeyboardShortcuts(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'f':
                        e.preventDefault();
                        document.getElementById('searchInput').focus();
                        break;
                    case 'a':
                        if (e.target.tagName !== 'INPUT' && e.target.tagName !== 'TEXTAREA') {
                            e.preventDefault();
                            document.getElementById('taskInput').focus();
                        }
                        break;
                }
            }
        }

        function generateId() {
            return Date.now() + Math.random();
        }

        function addTask() {
            const input = document.getElementById('taskInput');
            const categorySelect = document.getElementById('categorySelect');
            const prioritySelect = document.getElementById('prioritySelect');
            const dueDateInput = document.getElementById('dueDateInput');
            const notesInput = document.getElementById('taskNotes');
            
            const text = input.value.trim();
            
            if (text) {
                const newTask = {
                    id: generateId(),
                    text: text,
                    completed: false,
                    category: categorySelect.value,
                    priority: prioritySelect.value,
                    dueDate: dueDateInput.value || null,
                    notes: notesInput.value.trim() || '',
                    createdAt: new Date().toISOString()
                };

                tasks.unshift(newTask); // Add to beginning for better UX
                
                // Reset form
                input.value = '';
                notesInput.value = '';
                notesInput.style.display = 'none';
                dueDateInput.value = '';
                prioritySelect.value = 'low';
                
                saveTasks();
                renderTasks();
                updateStatistics();
                showNotification(`‚úÖ Task "${text}" added successfully!`);
                
                // Auto-focus back to input
                setTimeout(() => input.focus(), 100);
            }
        }

        function addTemplate(text, category, priority) {
            const newTask = {
                id: generateId(),
                text: text,
                completed: false,
                category: category,
                priority: priority,
                dueDate: null,
                notes: '',
                createdAt: new Date().toISOString()
            };

            tasks.unshift(newTask);
            saveTasks();
            renderTasks();
            updateStatistics();
            showNotification(`‚úÖ Template "${text}" added!`);
        }

        function toggleTask(id) {
            const task = tasks.find(t => t.id === id);
            if (task) {
                task.completed = !task.completed;
                
                if (task.completed) {
                    showConfetti();
                    playCompletionSound();
                    showNotification(`üéâ Great job completing "${task.text}"!`);
                }
                
                saveTasks();
                renderTasks();
                updateStatistics();
            }
        }

        function deleteTask(id) {
            const task = tasks.find(t => t.id === id);
            if (task && confirm(`Delete task "${task.text}"?`)) {
                tasks = tasks.filter(task => task.id !== id);
                saveTasks();
                renderTasks();
                updateStatistics();
                showNotification('üóëÔ∏è Task deleted');
            }
        }

        function startEdit(id, text, notes = '') {
            editingId = id;
            renderTasks();
            // Focus the edit input after rendering
            setTimeout(() => {
                const editInput = document.querySelector('.edit-input');
                if (editInput) {
                    editInput.focus();
                    editInput.select();
                }
            }, 0);
        }

        function saveEdit(id) {
            const editInput = document.querySelector('.edit-input');
            const editTextarea = document.querySelector('.edit-textarea');
            
            if (editInput && editInput.value.trim()) {
                const task = tasks.find(t => t.id === id);
                if (task) {
                    task.text = editInput.value.trim();
                    task.notes = editTextarea ? editTextarea.value.trim() : task.notes;
                    saveTasks();
                    showNotification('‚úèÔ∏è Task updated');
                }
            }
            editingId = null;
            renderTasks();
        }

        function cancelEdit() {
            editingId = null;
            renderTasks();
        }

        function setFilter(filter) {
            currentFilter = filter;
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-filter="${filter}"]`).classList.add('active');
            renderTasks();
        }

        function getFilteredTasks() {
            let filtered = tasks;

            // Apply search filter
            if (searchTerm) {
                filtered = filtered.filter(task => 
                    task.text.toLowerCase().includes(searchTerm) ||
                    task.notes.toLowerCase().includes(searchTerm) ||
                    task.category.toLowerCase().includes(searchTerm)
                );
            }

            // Apply category/status filters
            switch (currentFilter) {
                case 'completed':
                    return filtered.filter(task => task.completed);
                case 'active':
                    return filtered.filter(task => !task.completed);
                case 'high':
                    return filtered.filter(task => task.priority === 'high');
                case 'today':
                    const today = new Date().toISOString().split('T')[0];
                    return filtered.filter(task => task.dueDate === today);
                case 'overdue':
                    return filtered.filter(task => isOverdue(task));
                default:
                    return filtered;
            }
        }

        function isOverdue(task) {
            if (!task.dueDate || task.completed) return false;
            return new Date(task.dueDate) < new Date().setHours(0,0,0,0);
        }

        function isDueToday(task) {
            if (!task.dueDate) return false;
            return task.dueDate === new Date().toISOString().split('T')[0];
        }

        function getDueStatus(task) {
            if (!task.dueDate) return '';
            
            const today = new Date().toISOString().split('T')[0];
            const dueDate = new Date(task.dueDate);
            const todayDate = new Date(today);
            
            if (task.dueDate === today) {
                return 'due-today';
            } else if (dueDate < todayDate) {
                return 'due-overdue';
            } else {
                return 'due-upcoming';
            }
        }

        function formatDueDate(dateString) {
            if (!dateString) return '';
            
            const date = new Date(dateString);
            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            const dateStr = date.toISOString().split('T')[0];
            const todayStr = today.toISOString().split('T')[0];
            const tomorrowStr = tomorrow.toISOString().split('T')[0];
            
            if (dateStr === todayStr) return 'üìÖ Today';
            if (dateStr === tomorrowStr) return 'üìÖ Tomorrow';
            if (date < today) return '‚ö†Ô∏è Overdue';
            
            return 'üìÖ ' + date.toLocaleDateString();
        }

        function renderTasks() {
            const container = document.getElementById('tasksContainer');
            const filteredTasks = getFilteredTasks();

            if (filteredTasks.length === 0) {
                let emptyMessage = 'No tasks found';
                if (searchTerm) {
                    emptyMessage = `No tasks match "${searchTerm}"`;
                } else {
                    switch(currentFilter) {
                        case 'active': emptyMessage = 'üéâ No active tasks! Great job!'; break;
                        case 'completed': emptyMessage = 'üìù No completed tasks yet'; break;
                        case 'high': emptyMessage = 'üòå No high priority tasks'; break;
                        case 'today': emptyMessage = 'üìÖ Nothing due today'; break;
                        case 'overdue': emptyMessage = 'üëç No overdue tasks!'; break;
                        default: emptyMessage = 'üöÄ Ready to be productive? Add your first task!'; break;
                    }
                }
                
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">üìù</div>
                        ${emptyMessage}
                    </div>
                `;
                return;
            }

            container.innerHTML = filteredTasks.map(task => `
                <div class="task-item ${task.completed ? 'completed' : ''} ${task.priority}-priority ${isOverdue(task) ? 'overdue' : ''}" 
                     draggable="true" 
                     ondragstart="handleDragStart(event, ${task.id})"
                     ondragover="handleDragOver(event)"
                     ondrop="handleDrop(event, ${task.id})">
                     
                    <div class="drag-indicator"></div>
                    
                    <div class="task-checkbox">
                        <div class="checkbox ${task.completed ? 'checked' : ''}" onclick="toggleTask(${task.id})">
                            ${task.completed ? '‚úì' : ''}
                        </div>
                    </div>
                    
                    <div class="task-content">
                        ${editingId === task.id ? `
                            <input type="text" class="edit-input" value="${task.text}" 
                                   onkeydown="handleEditKeydown(event, ${task.id})" maxlength="200">
                            ${task.notes ? `<textarea class="edit-textarea" onkeydown="handleEditKeydown(event, ${task.id})">${task.notes}</textarea>` : ''}
                        ` : `
                            <div class="task-header">
                                <div class="task-text ${task.completed ? 'completed' : ''}">${task.text}</div>
                            </div>
                            <div class="task-meta">
                                <span class="task-category category-${task.category}">${getCategoryIcon(task.category)} ${task.category}</span>
                                <span class="task-priority priority-${task.priority}">${getPriorityIcon(task.priority)} ${task.priority}</span>
                                ${task.dueDate ? `<span class="task-due ${getDueStatus(task)}">${formatDueDate(task.dueDate)}</span>` : ''}
                            </div>
                            ${task.notes ? `<div class="task-notes">üí≠ ${task.notes}</div>` : ''}
                        `}
                    </div>
                    
                    <div class="task-actions">
                        ${editingId === task.id ? `
                            <button class="action-btn save-btn" onclick="saveEdit(${task.id})">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
                                </svg>
                            </button>
                            <button class="action-btn cancel-btn" onclick="cancelEdit()">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <line x1="18" y1="6" x2="6" y2="18"></line>
                                    <line x1="6" y1="6" x2="18" y2="18"></line>
                                </svg>
                            </button>
                        ` : `
                            <button class="action-btn edit-btn" onclick="startEdit(${task.id}, '${task.text.replace(/'/g, "\\'")}', '${task.notes.replace(/'/g, "\\'")}')">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                                    <path d="m18.5 2.5 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                                </svg>
                            </button>
                            <button class="action-btn delete-btn" onclick="deleteTask(${task.id})">
                                <svg class="icon" viewBox="0 0 24 24">
                                    <line x1="18" y1="6" x2="6" y2="18"></line>
                                    <line x1="6" y1="6" x2="18" y2="18"></line>
                                </svg>
                            </button>
                        `}
                    </div>
                </div>
            `).join('');
        }

        function getCategoryIcon(category) {
            const icons = {
                personal: 'üìù',
                work: 'üíº',
                shopping: 'üõí',
                health: 'üèÉ'
            };
            return icons[category] || 'üìù';
        }

        function getPriorityIcon(priority) {
            const icons = {
                high: 'üî¥',
                medium: 'üü°',
                low: 'üîµ'
            };
            return icons[priority] || 'üîµ';
        }

        // Drag and Drop
        function handleDragStart(e, taskId) {
            draggedElement = taskId;
            e.target.classList.add('dragging');
        }

        function handleDragOver(e) {
            e.preventDefault();
        }

        function handleDrop(e, targetTaskId) {
            e.preventDefault();
            
            if (draggedElement && draggedElement !== targetTaskId) {
                const draggedIndex = tasks.findIndex(t => t.id === draggedElement);
                const targetIndex = tasks.findIndex(t => t.id === targetTaskId);
                
                if (draggedIndex !== -1 && targetIndex !== -1) {
                    const [draggedTask] = tasks.splice(draggedIndex, 1);
                    tasks.splice(targetIndex, 0, draggedTask);
                    
                    saveTasks();
                    renderTasks();
                    showNotification('üìã Tasks reordered');
                }
            }
            
            document.querySelectorAll('.task-item').forEach(item => {
                item.classList.remove('dragging');
            });
            draggedElement = null;
        }

        // Statistics
        function updateStatistics() {
            const total = tasks.length;
            const completed = tasks.filter(t => t.completed).length;
            const pending = total - completed;
            const highPriority = tasks.filter(t => t.priority === 'high' && !t.completed).length;
            const dueToday = tasks.filter(t => isDueToday(t) && !t.completed).length;
            const overdue = tasks.filter(t => isOverdue(t)).length;

            // Header stats
            document.getElementById('headerTotal').textContent = total;
            document.getElementById('headerCompleted').textContent = completed;
            document.getElementById('headerPending').textContent = pending;
            document.getElementById('headerStreak').textContent = getCompletionStreak();

            // Statistics cards
            const stats = document.getElementById('statistics');
            stats.innerHTML = `
                <div class="stat-card">
                    <div class="stat-value">${total}</div>
                    <div class="stat-label">Total Tasks</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${completed}</div>
                    <div class="stat-label">Completed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${pending}</div>
                    <div class="stat-label">Pending</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${Math.round(total > 0 ? (completed / total) * 100 : 0)}%</div>
                    <div class="stat-label">Completion Rate</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${highPriority}</div>
                    <div class="stat-label">High Priority</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${dueToday}</div>
                    <div class="stat-label">Due Today</div>
                </div>
            `;
        }

        function getCompletionStreak() {
            // Simple streak calculation - days with at least one completed task
            const completedTasks = tasks.filter(t => t.completed);
            if (completedTasks.length === 0) return 0;
            
            // For demo purposes, return a random streak between 1-7
            return Math.floor(Math.random() * 7) + 1;
        }

        // Theme
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            document.getElementById('themeIcon').textContent = newTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
            
            localStorage.setItem('theme', newTheme);
            showNotification(`üé® Switched to ${newTheme} mode`);
        }

        function loadTheme() {
            const savedTheme = localStorage.getItem('theme') || 'light';
            document.documentElement.setAttribute('data-theme', savedTheme);
            document.getElementById('themeIcon').textContent = savedTheme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
        }

        // Notifications
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Confetti effect
        function showConfetti() {
            const canvas = document.getElementById('confetti');
            const ctx = canvas.getContext('2d');
            
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            const confetti = [];
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#96ceb4', '#feca57', '#ff9ff3'];
            
            for (let i = 0; i < 50; i++) {
                confetti.push({
                    x: Math.random() * canvas.width,
                    y: -10,
                    vx: Math.random() * 4 - 2,
                    vy: Math.random() * 3 + 2,
                    color: colors[Math.floor(Math.random() * colors.length)],
                    size: Math.random() * 8 + 4
                });
            }
            
            function animateConfetti() {
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                for (let i = confetti.length - 1; i >= 0; i--) {
                    const c = confetti[i];
                    
                    ctx.fillStyle = c.color;
                    ctx.fillRect(c.x, c.y, c.size, c.size);
                    
                    c.x += c.vx;
                    c.y += c.vy;
                    c.vy += 0.1;
                    
                    if (c.y > canvas.height) {
                        confetti.splice(i, 1);
                    }
                }
                
                if (confetti.length > 0) {
                    requestAnimationFrame(animateConfetti);
                }
            }
            
            animateConfetti();
        }

        // Sound effects
        function playCompletionSound() {
            // Create a simple completion sound using Web Audio API
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);
            
            oscillator.frequency.setValueAtTime(800, audioContext.currentTime);
            oscillator.frequency.setValueAtTime(1000, audioContext.currentTime + 0.1);
            
            gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
            
            oscillator.start(audioContext.currentTime);
            oscillator.stop(audioContext.currentTime + 0.2);
        }

        // Bulk actions
        function bulkComplete() {
            const activeTasks = tasks.filter(t => !t.completed);
            if (activeTasks.length > 0 && confirm(`Mark ${activeTasks.length} tasks as completed?`)) {
                tasks.forEach(task => {
                    if (!task.completed) task.completed = true;
                });
                saveTasks();
                renderTasks();
                updateStatistics();
                showNotification(`üéâ Marked ${activeTasks.length} tasks as completed!`);
            }
        }

        function bulkDelete() {
            const completedTasks = tasks.filter(t => t.completed);
            if (completedTasks.length > 0 && confirm(`Delete ${completedTasks.length} completed tasks?`)) {
                tasks = tasks.filter(t => !t.completed);
                saveTasks();
                renderTasks();
                updateStatistics();
                showNotification(`üóëÔ∏è Deleted ${completedTasks.length} completed tasks`);
            }
        }

        // Import/Export
        function exportTasks() {
            const dataStr = JSON.stringify(tasks, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            
            const link = document.createElement('a');
            link.href = URL.createObjectURL(dataBlob);
            link.download = `todo-backup-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            showNotification('üíæ Tasks exported successfully!');
        }

        function importTasks() {
            document.getElementById('importFile').click();
        }

        function handleImport(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const importedTasks = JSON.parse(e.target.result);
                        if (Array.isArray(importedTasks)) {
                            tasks = importedTasks;
                            saveTasks();
                            renderTasks();
                            updateStatistics();
                            showNotification(`üì• Imported ${importedTasks.length} tasks!`);
                        }
                    } catch (error) {
                        alert('Error importing file. Please check the format.');
                    }
                };
                reader.readAsText(file);
            }
        }

        // Due date checking
        function checkDueDates() {
            const dueTasks = tasks.filter(t => isDueToday(t) && !t.completed);
            const overdueTasks = tasks.filter(t => isOverdue(t));
            
            if (dueTasks.length > 0) {
                console.log(`üìÖ ${dueTasks.length} tasks due today`);
            }
            if (overdueTasks.length > 0) {
                console.log(`‚ö†Ô∏è ${overdueTasks.length} overdue tasks`);
            }
        }

        // Edit keydown handler
        function handleEditKeydown(event, id) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                saveEdit(id);
            } else if (event.key === 'Escape') {
                cancelEdit();
            }
        }

        // Data persistence
        function saveTasks() {
            localStorage.setItem('advancedTodoTasks', JSON.stringify(tasks));
        }
    </script>

</body></html>